# DevTools clang-format configuration
# Based on Google style with Qt adaptations

BasedOnStyle: Google
Language: Cpp
Standard: c++17

# Indentation
IndentWidth: 4
TabWidth: 4
UseTab: Never
IndentCaseLabels: false
IndentCaseBlocks: false
NamespaceIndentation: None
AccessModifierOffset: -4

# Line length and wrapping
ColumnLimit: 100
AlwaysBreakTemplateDeclarations: Yes
AlwaysBreakAfterReturnType: None
AllowShortBlocksOnASingleLine: Empty
AllowShortCaseLabelsOnASingleLine: false
AllowShortFunctionsOnASingleLine: Inline
AllowShortIfStatementsOnASingleLine: Never
AllowShortLoopsOnASingleLine: false
AllowShortLambdasOnASingleLine: Inline

# Braces
BreakBeforeBraces: Custom
BraceWrapping:
  AfterCaseLabel: false
  AfterClass: true
  AfterControlStatement: Never
  AfterEnum: false
  AfterFunction: true
  AfterNamespace: false
  AfterStruct: true
  AfterUnion: false
  AfterExternBlock: false
  BeforeCatch: false
  BeforeElse: false
  BeforeLambdaBody: false
  BeforeWhile: false
  IndentBraces: false
  SplitEmptyFunction: false
  SplitEmptyRecord: false
  SplitEmptyNamespace: false

# Alignment
AlignAfterOpenBracket: Align
AlignConsecutiveAssignments: None
AlignConsecutiveDeclarations: None
AlignConsecutiveMacros: None
AlignEscapedNewlines: Left
AlignOperands: Align
AlignTrailingComments: true

# Spaces
SpaceAfterCStyleCast: false
SpaceAfterLogicalNot: false
SpaceAfterTemplateKeyword: true
SpaceBeforeAssignmentOperators: true
SpaceBeforeCpp11BracedList: false
SpaceBeforeCtorInitializerColon: true
SpaceBeforeInheritanceColon: true
SpaceBeforeParens: ControlStatements
SpaceBeforeRangeBasedForLoopColon: true
SpaceInEmptyBlock: false
SpaceInEmptyParentheses: false
SpacesBeforeTrailingComments: 1
SpacesInAngles: Never
SpacesInCStyleCastParentheses: false
SpacesInConditionalStatement: false
SpacesInContainerLiterals: false
SpacesInParentheses: false
SpacesInSquareBrackets: false

# Includes
IncludeBlocks: Regroup
IncludeCategories:
  # Project headers (local includes with quotes)
  - Regex: '^"'
    Priority: 1
    SortPriority: 1
  # Qt headers
  - Regex: '^<Q'
    Priority: 2
    SortPriority: 2
  # Third-party headers
  - Regex: '^<(yaml-cpp|toml|nlohmann|gtest)'
    Priority: 3
    SortPriority: 3
  # Standard library
  - Regex: '^<[a-z_]+>'
    Priority: 4
    SortPriority: 4
  # Other system headers
  - Regex: '<.*>'
    Priority: 5
    SortPriority: 5
SortIncludes: CaseSensitive
IncludeIsMainRegex: '(_test|_gui)?$'

# Pointer and reference alignment
DerivePointerAlignment: false
PointerAlignment: Right
ReferenceAlignment: Right

# Constructor initializers
BreakConstructorInitializers: BeforeComma
ConstructorInitializerIndentWidth: 4
PackConstructorInitializers: NextLine

# Comments
ReflowComments: true
FixNamespaceComments: true

# Penalties
PenaltyBreakAssignment: 2
PenaltyBreakBeforeFirstCallParameter: 1
PenaltyBreakComment: 300
PenaltyBreakFirstLessLess: 120
PenaltyBreakOpenParenthesis: 0
PenaltyBreakString: 1000
PenaltyExcessCharacter: 1000000
PenaltyReturnTypeOnItsOwnLine: 200

# Qt-specific macros
StatementMacros:
  - Q_OBJECT
  - Q_PROPERTY
  - Q_DECLARE_METATYPE
  - Q_DISABLE_COPY
  - Q_SIGNALS
  - Q_SLOTS
AttributeMacros:
  - emit
  - Q_EMIT

# Lambdas
LambdaBodyIndentation: Signature

# Other
Cpp11BracedListStyle: true
InsertBraces: false
InsertNewlineAtEOF: true
KeepEmptyLinesAtTheStartOfBlocks: false
MaxEmptyLinesToKeep: 1
SeparateDefinitionBlocks: Leave
SortUsingDeclarations: true
